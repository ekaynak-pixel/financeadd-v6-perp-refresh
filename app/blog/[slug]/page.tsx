import {getDB,decompressToString} from '../../../lib/db';import {notFound} from 'next/navigation';import {mdToHtml} from '../../../lib/md';import dynamic from 'next/dynamic';
const CSEBlock=dynamic(()=>import('../../../components/CSEBlock'),{ssr:false});const UnifiedWebResults=dynamic(()=>import('../../../components/UnifiedWebResults'),{ssr:false});
export default async function PostPage({params}:{params:{slug:string}}){const db=getDB();const post=db.prepare('SELECT * FROM posts WHERE slug=?').get(params.slug);if(!post) return notFound();const md=decompressToString(post.content_compressed);const html=await mdToHtml(md);const query=post.title||params.slug.replace(/-/g,' ');
return(<div className="grid gap-6"><article className="card"><h1 className="text-2xl font-semibold">{post.title}</h1><div className="small mb-2">{new Date(post.created_at).toLocaleString()}</div><div className="badge mb-2">Google results</div><CSEBlock query={query} resultsOnly /><div className="badge mt-6 mb-2">Suggested web articles</div><UnifiedWebResults term={query} /></article><article className="card prose prose-invert max-w-none" dangerouslySetInnerHTML={{__html:html}} /></div>)}
